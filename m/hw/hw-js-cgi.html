<html><head><title>Hans Wehr</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style>
body { width: 100%; background-color: #DDD; }
#chapters_index, #chapter_contents, table.navtable { width: 100%; }
#chapter_contents { font-family: Simplified Arabic; }
table.navtable td { width: 25%; }
body, div { margin: 0; padding: 0; }
a { 
	color: black;
	text-decoration: none;
	}
.indexbutton { 
	margin: 0; padding: 0;
	padding-right: 15px;
	padding-left: 15px;
	font-size: xx-large;
	width: 100%; background-color: silver;
	}
.button { 
	font-size: xx-large;
	width: 100%; background-color: silver;
	font-size: xx-large; text-align: center; 
	padding-top: 10px; padding-bottom: 10px; 
	}
.small_button { 
	width: 100%; background-color: silver;
	text-align: center; 
	}

hr { margin: 5px; }
	
.column_indicator { width: 100% }
.column_indicator td { margin: 2; padding: 2; background-color: gray; }
.act  { background-color: blue; }
.index_table td { 
	font-size: xx-large; 
	text-align: center; 
	}
/*
	padding-top: 10px; padding-bottom: 10px; 
.button td {	height: 100%; }
	.index_table td { border-left: 1 solid black; }
	border-top: 2 solid    white; 
	border-left: 2 solid   white; 
	border-right: 2 solid  gray; 
	border-bottom: 2 solid gray; 
*/

/*
	top: 100%;
image = 663x1064
	left: 0px;
	position: absolute;
	background-image: url('hw-39-final-web_cropped.gif');
	width: 663px;
  background: white url('hw-39-final-web_cropped.gif') no-repeat scroll left top; 
	background-image: url('hw-39-final-web_cropped.gif');
	height: 300px;
	top: -50px;
<meta name='viewport' content='width=device-width, initial-scale=1.0'/>  
*/

.column {
	width: 98%;
	overflow: hidden;
}
#imgcol1 {
	position: relative;
	width: 200%;
	display: none;
}
#imgcol2 {
	position: relative;
	width: 200%;
	right: 100%;
	display: none;
}
#about { display: none; }
/*
<a href='../0/hw-38-mobile.html'><div class='button'>&larr; [38] - prev page</div></a><br>
<a href='../chapter_2.html'><div class='button'>&uarr; Chapter index</div></a><br>
*/
</style>
<meta name='viewport' content='width=device-width'/>  
</head>
<body>

<a href="/m/aa/" >
<div style='width: 100%; height: 5%; color: #FF0; background-color: black; border: 1 solid #FF0;'>
Check out the new and improved version, click here for Arabic Almanac</div>
</a>
<a href="http://ejtaal.net/donate/" >
<div style='margin: 1%; width: 100%; height: 5%; color: white; background-color: navy; border: 1 solid white;'>
<center>
::: Please donate if you like this page, click here :::
</center>
</div>
<table class='navtable'>
<tr>
	<td> <a href='javascript:prev()' id='a_prev'><div class='button'>&larr;</div></a> </td>
	<td> <a href='javascript:showindex()'><div class='button'>index</div></a> </td>
	<td> <a href='javascript:next()' id='a_next'><div class='button'>&rarr;</div></a> </td>
</tr>
<tr>
	<td> <a href='javascript:show_about()'> <div class='button'>about</div> </a> </td>
	<td> <a href='javascript:toggle_view()'> <div class='button'>view</div> </a> </td>
	<td> <a href='javascript:searchandgo()'><div class='button'>search</div></a> </td>
</tr>
</table>

<!--
	<td> <a href='javascript:zoom_out()'> <div class='button'>-</div> </a> </td>
	<td> <a href='javascript:zoom_in()'> <div class='button'>+</div> </a> </td>
	Search root letters:
	<input type=text id='search' maxlength='4'>
	<input type=submit onClick='javascript:searchandgo()' value='Go'>
<a href='../0/hw-38-mobile.html'><div class='button'>&lt; [38] - previous page</div></a><br>
<a href='../chapter_2.html'><div class='button'>&lt;- Chapter index</div></a><br>
<a href='javascript:toggle_view()'><div class='button'>Toggle</div></a><br>

<div id='chaplist'>
	<input type=submit onClick='javascript:showindex(5)' value='1'>
	<input type=submit onClick='javascript:showchap(6)' value='2'>
</div>
-->
<center>
<small>
<span id='statusbar'></span>
<span id='searchbar'></span>
| Viewing mode: <em><span id='currentmode'></span></em>.
</small>
<hr>

</center>
<div id=about>
<h3>About this page</h3>
<p>
Salam alaykum, ahlan wa sahlan, welcome to my new and improved Book Browser 
interface. The goal of this page is
to provide the quickest way possible to access the pages of the Hans Wehr dictionary without the
need to be connected to this webserver. I have been using this interface on my android smart phone for 
a while now and have found it approximately twice as fast as using the physical dictionary.

<p>
This interface has been implemented using nothing but JavaScript and has
been tested to work with both desktop browsers and mobile browsers. Sofar
this website has been confirmed by users to work in Opera (desktop &
mobile versions), Google Chrome, iPhone and Firefox (desktop version
at least). 
Depending on your screen resolution it will decide upon
first load to either use full width view or single column view mode,
so that it should select full view when you use this page on a largish
desktop/tablet screen but column mode if you access it using your smart
phone. You can always change the view manually with the 'View' button. The
page also uses a cookie to bring you back to the last page you viewed.

<p>
Here is list of the available keyboard shortcuts you can use for the main functions
of this website:
<pre>
search (find): f
back 1 page: left arrow, d or z
forward 1 page: right arrow, g or x
</pre>

You may now also type english (roman) letters in the search box and they will be
automatically transformed into the arabic form used by the website search functionality.
This may be of great benefit for those people who are not able for whatever reason to install
and use an arabic keyboard and/or layout.
So for example: If you search for "bqr" it will automatically become: "بقر" inshallah :)
Here is the list of english letters that will become their corresponding arabic letter:
<pre>
Double letters:
th -> "ث"
gh -> "غ"
kh -> "خ"
sh -> "ش"
dh -> "ذ"

Different cases:
d -> "د"
D -> "ض"
z -> "ز"
Z -> "ظ"
s -> "س"
S -> "ص"
t -> "ت"
T -> "ط"
h -> "ه"
H -> "ح"

All other "normal" letters:
a -> "ا"
b -> "ب"
j -> "ج"
7 -> "ح"
r -> "ر"
3 -> "ع"
f -> "ف"
q -> "ق"
k -> "ك"
l -> "ل"
m -> "م"
n -> "ن"
w -> "و"
y -> "ي"
</pre>

<p>
You can now download the entire website and install it for instance on your phone's SD card
or your desktop PC for super fast access :).<br>
Download link: <a class=small_button href="../hw.zip">hw.zip</a>. The size is about
80 MB. When you have placed the entire "hw" folder from the zip file on your SD card, I recommend
using the free Opera browser to go the following url:
<a href="file://localhost/sdcard">
file://localhost/sdcard
</a>, then locate the "hw" folder and click on index.html, and hopefully it should
work :)

<p>
I welcome positive and/or constructive negative feedback. You can reach me here:<br>
&copy; 2011 by Abdurahman Erik Taal (<a class=small_button href='mailto:ejtaal@gmail.com'>ejtaal@gmail.com</a>)
<p>The search facility
uses data generously provided by Ahmad Sheikh (<a class=small_button href='mailto:ahmadzsheikh at gmail'>contact</a>).

<p>
Bugs: This site doesn't seem to work in Internet Explorer and may never
do unless there is a web developer out there that can send me bugfixes :)

<p>
Source and the latest version: <a class=small_button href='http://ejtaal.net/m'>ejtaal.net/m</a><br>
</div>
<div id=chapters_index>
</div>

<div id=chapter_contents>
</div>

<center>
<div id='narrowview'>

<div class='column' id='col1'>
<table class='column_indicator'><tr>
<td><div class="act">&nbsp;</div></td>
<td><div >&nbsp;</div></td>
</tr></table>
	<img id='imgcol1'>
</div>

<div class='column' id='col2'>
<table class='column_indicator'><tr>
<td><div >&nbsp;</div></td>
<td><div class="act">&nbsp;</div></td>
</tr></table>
	<img id='imgcol2'>
</div>

</div>

<div id='wideview'>
<img id='wideviewimg'>
</div>
<!--
            "<td><div $td_class>&nbsp;</div></td>", FILE_APPEND);
        }
        file_put_contents( "$mobile_dir/$mobile_html_file",
          "</tr></table>
<img id='col2' src='hw-39-final-web_cropped.gif'>
<table class='column_indicator'><tr><td><div class="act">&nbsp;</div></td><td><div >&nbsp;</div></td></tr></table>
<img src='hw-39-1of2.gif'><br>
<table class='column_indicator'><tr><td><div >&nbsp;</div></td><td><div class="act">&nbsp;</div></td></tr></table>
<img src='hw-39-2of2.gif'><br>
<a href='../0/hw-40-mobile.html'><div class='button'>next page - [40] &gt;</div></a><br>
-->
<table class='navtable'>
<tr>
	<td> <a href='javascript:prev()' id='a_prev2'><div class='button'>&larr;</div></a> </td>
	<td> <a href='javascript:showindex()'><div class='button'>index</div></a> </td>
	<td> <a href='javascript:next()' id='a_next2'><div class='button'>&rarr;</div></a> </td>
</tr>
<tr>
	<td> <a href='javascript:show_about()'> <div class='button'>about</div> </a> </td>
	<td> <a href='javascript:toggle_view()'> <div class='button'>view</div> </a> </td>
	<td> <a href='javascript:searchandgo()'><div class='button'>search</div></a> </td>
</tr>
</table>

<!--
http://www.openjs.com/scripts/events/keyboard_shortcuts/
-->
<script type="text/javascript" src="shortcut.js"></script>
<script type="text/javascript" src="hw-headers.js"></script>
<script>
// Some global variables.
var toggle = 1;
var start_page = 19;
var total_pages = 1129;
var cur_chapter;
var cur_page;
var toggle_view_auto = 1;
var toggle_view_mode;
var last_input = "";

shortcut.add("F",function() { searchandgo(); });
shortcut.add("Z",function() { prev(); });
shortcut.add("X",function() { next(); });
shortcut.add("D",function() { prev(); });
shortcut.add("G",function() { next(); });
shortcut.add("Left",function() { prev(); });
shortcut.add("Right",function() { next(); });

function getchap( page) {
	// Return chapter of current page
	for (var i = 0; i < chapters.length; i++) {
		if ( chapters[i][1] >= page) { return i-1; }
	}
	return 0;
}
function showindex() {
	document.getElementById("chapters_index").innerHTML = '<hr>';
	for (var i = 0; i < chapters.length; i++) {
		document.getElementById("chapters_index").innerHTML += 
			"<a href='javascript:showchap(" + i + ")'><span class='indexbutton'> " +
			chapters[i][0] + " </span></a>\n";
	}
	document.getElementById("about").style['display'] = 'none';
	scroll( 0, 0);
}

function showcurchap() { showchap( getchap(cur_page)) };
function showchap( chap) {
	var end;
	document.getElementById("chapters_index").innerHTML = '';
	document.getElementById("chapter_contents").innerHTML = '<hr>';
	if ( chap == chapters.length - 1 ) { end = items.length + offset; }
	else { end = chapters[chap+1][1]; }
	//alert( 'end = ' + end );
	for (var i = chapters[chap][1]; i < end; i++) {
		var header_index = i - offset;
		var append = '';
		if ( header_index < 0) { append = 'page ' + i; }
		else { append = items[header_index]; } 
		document.getElementById("chapter_contents").innerHTML += 
			"<a href='#" + i + "'><span class='indexbutton'> " +
			append + " </span></a>\n";
	}
	document.getElementById("about").style['display'] = 'none';
	scroll( 0, 0);
}

function toggle_view() {
	toggle_view_auto = 0;
	if (toggle == 1) {
		document.getElementById("narrowview").style['display'] = 'none';
		document.getElementById("wideview").style['display'] = 'block';
		document.getElementById("currentmode").innerHTML = 'full page width';
		toggle_view_mode = 1;
		toggle = 2;
	} else {
		document.getElementById("narrowview").style['display'] = 'block';
		document.getElementById("wideview").style['display']   = 'none';
		document.getElementById("currentmode").innerHTML = 'single column';
		toggle = 1;
		toggle_view_mode = 2;
	}

	//setCookie( "toggle_view_auto", toggle_view_auto, 365);
	//setCookie( "toggle_view_mode", toggle_view_mode, 365);
}

window.onhashchange = handle_hash_change;
function handle_hash_change() {
	//alert( "hash change!!!(), hash.substring(1) = " + self.document.location.hash.substring(1) + ", hash = " + self.document.location.hash + ".");
	wanted_page = self.document.location.hash.substring(1);
	if ( typeof(wanted_page) != "undefined" && wanted_page != null && wanted_page > 0) {
		load_imgs( wanted_page);
	}
}

// Page load is called once all the way at the bottom
function page_load() {
	//alert( document.documentElement.clientWidth);
	//alert( "page load(), hash.substring(1) = " + self.document.location.hash.substring(1) + ", hash = " + self.document.location.hash + ".");
	/*
	var last_pagetoggle_view_mode = getCookie("toggle_view_mode");
	var toggle_view_auto = getCookie("toggle_view_auto");
	if ( toggle_view_mode != null && toggle_view_mode != "" &&
		toggle_view_auto != null && toggle_view_auto != "") {
		//alert( "toggle_view_mode = " + toggle_view_mode);
		//alert( "toggle_view_auto = " + toggle_view_auto);
		toggle = toggle_view_mode;
	} else {
	}
	*/
		// Do autodetection of wide/column mode view
	if ( document.documentElement.clientWidth < 750){ toggle = 2; } 
	else { toggle = 1; }
	toggle_view();
	
	//document.getElementById("narrowview").style['display'] = 'none';
	var last_page = getCookie("last_page");
	//alert( last_page);
	//alert( self.document.location.hash.substring(1));
	//self.document.location.hash = 'blahdieblah';
	wanted_page = self.document.location.hash.substring(1);
	if ( typeof(wanted_page) != "undefined" && wanted_page != null && wanted_page > 0) {
		//alert("wanted page = " + wanted_page);
		self.document.location.hash = wanted_page;
	} else if ( last_page != null && last_page != "" && last_page > 0) {
		//alert(2);
		self.document.location.hash = last_page;
	} else {
		//alert(3);
		// This is most likely the first visit? Show about then.
		//self.document.location.hash = start_page;
		load_imgs( start_page);
		show_about();
	}

	// Call it here as it won't get triggered for wanted page
	// or when page gets loaded from cache after browser restart
	handle_hash_change();
}

function show_about() {
		//alert('showing about');
		document.getElementById('about').style['display'] = 'block';
}


function searchandgo() {
	//var search = document.getElementById('search').value;
	var input = prompt( "Enter root letters in english or arabic to search (see About section)", last_input);
	var search = input;
	last_input = input;
	// TODO: converting all forms of alif and hamza                                             
	// (ء, آ, أ, ؤ, إ, ئ, ا) to a single character ء
	// The same should be done for both forms of yaa (ي, ى)
	/*
		Perform search and replace according to the Arabic Chat Alphabet:
		http://en.wikipedia.org/wiki/Arabic_chat_alphabet
	search = search.replace(//gi,"");
	*/
	// Firstly the letters that take IMHO 2 letters to transliterate
	search = search.replace(/th/g,"ث");
	search = search.replace(/gh/g,"غ");
	search = search.replace(/kh/g,"خ");
	search = search.replace(/sh/g,"ش");
	search = search.replace(/dh/g,"ذ");
	// Hmm, make the following case insensitive and assign different letters to different cases:
	search = search.replace(/d/g,"د");
	search = search.replace(/D/g,"ض");
	search = search.replace(/z/g,"ز");
	search = search.replace(/Z/g,"ظ");
	search = search.replace(/s/g,"س");
	search = search.replace(/S/g,"ص");
	search = search.replace(/t/g,"ت");
	search = search.replace(/T/g,"ط");
	search = search.replace(/h/g,"ه");
	search = search.replace(/H/g,"ح");
	// Not much iktilaaf over these I guess:
	search = search.replace(/a/g,"ا");
	search = search.replace(/b/g,"ب");
	search = search.replace(/j/g,"ج");
	search = search.replace(/7/g,"ح");
	search = search.replace(/r/g,"ر");
	search = search.replace(/3/g,"ع");
	search = search.replace(/f/g,"ف");
	search = search.replace(/q/g,"ق");
	search = search.replace(/k/g,"ك");
	search = search.replace(/l/g,"ل");
	search = search.replace(/m/g,"م");
	search = search.replace(/n/g,"ن");
	search = search.replace(/w/g,"و");
	search = search.replace(/y/g,"ي");
	//alert( "Searching for: " + search);
	var target_page = binarySearch(items, search) + offset;
	self.document.location.hash = target_page;
	document.getElementById("searchbar").innerHTML = 
		"| Searched for: <strong>" + input + "</strong> (" + search + ")";
	/*
	Hans Wehr - chapter <em class='small_button'><a href='javascript:showcurchap()'>" +
		chapters[getchap(page_num)][0] +
		"</a></em> - page " + page_num + " : " +
		"<strong>" + items[page_num-offset] + "</strong>";
	*/
	//load_imgs( target_page);
	//var target_url  = String(Math.floor(target_page/100)) + "/hw-" + String(target_page) + "-mobile.html";
	//window.location = target_url;
		
}

function prev() { window.location = document.getElementById("a_prev").href; }
function next() { window.location = document.getElementById("a_next").href; }

function load_imgs( page_num) {
	if ( page_num < 0 ) { page_num = 0; }
	if ( page_num > total_pages ) { page_num = total_pages - 1; }
	//alert( page_num);
	document.getElementById("about").style['display'] = 'none';
	setCookie( "last_page", page_num, 31);
	document.getElementById("chapters_index").innerHTML = '';
	document.getElementById("chapter_contents").innerHTML = '';
	document.getElementById("a_prev").href = '#' + (page_num-1);
	document.getElementById("a_next").href = '#' + parseInt(parseInt(page_num)+1);
	document.getElementById("a_prev2").href = '#' + (page_num-1);
	document.getElementById("a_next2").href = '#' + parseInt(parseInt(page_num)+1);
	//document.getElementById("a_prev").href = '?page=' + (page_num-1);
	//document.getElementById("a_next").href = '?page=' + parseInt(parseInt(page_num)+1);
	document.getElementById("statusbar").innerHTML = 
		"Hans Wehr - chapter <em class='small_button'><a href='javascript:showcurchap()'>" +
		chapters[getchap(page_num)][0] +
		"</a></em> - page " 
		+ "<input type=text size=5 onkeypress=\"checkKey(event)\" id=input_no value='" + (page_num-offset+1) + "'>"
		+ " : " +
		"<strong>" + items[page_num-offset] + "</strong>"
		;

	//+ page_num 
	document.title = 'p. ' + (page_num-offset+1) + ' (' + items[page_num-offset] + ') - Hans Wehr';
	var imgs = document.getElementsByTagName("img"); 
	var img_url = Math.floor(page_num/100) + "/hw-" + page_num + ".gif"; //img[i].src is the reference to the image. 
	for (var i = 0, l = imgs.length; i < l; i++) { 
		imgs[i].src = img_url;
		imgs[i].style['display'] = 'block';
	}
	scroll( 0, 0);
	cur_page = page_num;
	//alert( 'done loading');
}

function checkKey(e) {
    var charCode;
    
    if(e && e.which){
        charCode = e.which;
    }else if(window.event){
        e = window.event;
        charCode = e.keyCode;
    }

    if(charCode == 13) {
			self.document.location.hash = parseInt(document.getElementById("input_no").value) + offset - 1;
			//load_imgs( document.getElementById("input_no").value);
    }
}

function getCookie(c_name) {
	var i,x,y,ARRcookies=document.cookie.split(";");
	for (i=0;i<ARRcookies.length;i++) {
  	x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
  	y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
  	x=x.replace(/^\s+|\s+$/g,"");
  	if (x==c_name) { return unescape(y); }
  }
}

function setCookie(c_name,value,exdays)
{
	var exdate=new Date();
	exdate.setDate(exdate.getDate() + exdays);
	var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
	document.cookie=c_name + "=" + c_value;
}

//Copyright 2009 Nicholas C. Zakas. All rights reserved.
//MIT-Licensed, see source file
function binarySearch(items, value){
		value = value.replace( /\s*/g, "");

    var startIndex  = 0,
        stopIndex   = items.length - 1,
        middle      = Math.floor((stopIndex + startIndex)/2);

    while(items[middle] != value && startIndex < stopIndex){

        //adjust search area
        if (value < items[middle]){
            stopIndex = middle - 1;
        } else if (value > items[middle]){
            startIndex = middle + 1;
        }

        //recalculate middle
        middle = Math.floor((stopIndex + startIndex)/2);
    }

    //return (items[middle] != value) ? -1 : middle;
    return (items[middle] > value && middle > 0) ? middle-1 : middle;
}

// Do page_load once
page_load();

/* The javascript graveyard:

// Works, but not needed anymore
function queryString( key )
{
    var re = new RegExp( "[?&]" + key + "=([^&$]*)", "i" );
    var offset = location.search.search( re );
    if ( offset == -1 ) return null;
    return RegExp.$1;
}


function next() { load_imgs( parseInt(cur_page)+1) }
function prev() { load_imgs( parseInt(cur_page)-1) }
function go( page)
{
	// Or pop it onto the history stack?
	self.document.location.hash = page;
	load_imgs( page);
}
alert( unescape(self.document.location.hash.substring(1)));

which img we want:
unescape(self.document.location.hash.substring(1))


var imgs = document.getElementsByTagName("img"); 
for (var i = 0, l = imgs.length; i < l; i++) { 
	imgs[i].src ="hw-40-final-web_cropped.gif"; //img[i].src is the reference to the image. 
}
*/

</script>
</body>
</html>
